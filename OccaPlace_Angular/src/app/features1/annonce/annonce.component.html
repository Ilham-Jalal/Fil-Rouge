<div class="annonce-container">
  <h1>Gestion des Annonces</h1>

  <form (ngSubmit)="selectedAnnonce ? updateAnnonce() : createAnnonceWithImages()">
    <div>
      <label>Titre:</label>
      <input type="text" [(ngModel)]="updateAnnonceData.title" name="title" required>
    </div>

    <div>
      <label>Description:</label>
      <textarea [(ngModel)]="updateAnnonceData.description" name="description" required></textarea>
    </div>

    <div>
      <label>Prix:</label>
      <input type="number" [(ngModel)]="updateAnnonceData.price" name="price" required>
    </div>

    <div>
      <label>Catégorie:</label>
      <select [(ngModel)]="updateAnnonceData.category" name="category" required>
        <option *ngFor="let key of categorieKeys" [value]="key">{{ key }}</option>
      </select>
    </div>

    <div>
      <label>Disponibilité:</label>
      <select [(ngModel)]="updateAnnonceData.disponibilite" name="disponibilite" required>
        <option *ngFor="let key of disponibiliteKeys" [value]="key">{{ key }}</option>
      </select>
    </div>

    <div>
      <label>Images:</label>
      <input type="file" (change)="onFileChange($event)" multiple>
    </div>

    <button type="submit">{{ selectedAnnonce ? 'Mettre à jour' : 'Créer' }} l'annonce</button>
    <button type="button" (click)="resetForm()">Annuler</button>
  </form>

  <!-- Liste des annonces -->
  <div class="annonces-list">
    <h2>Liste des Annonces</h2>
    <div *ngFor="let annonce of annonces">
      <h3>{{ annonce.title }}</h3>
      <p>{{ annonce.description }}</p>
      <p>Prix: {{ annonce.price }}€</p>
      <p>Catégorie: {{ annonce.category }}</p>
      <p>Disponibilité: {{ annonce.disponibilite }}</p>

      <!-- Affichage des images -->
      <div *ngIf="annonce.images && annonce.images.length > 0">
        <h4>Images:</h4>
        <div *ngFor="let image of annonce.images">
          <img [src]="image" alt="Annonce Image" style="max-width: 100px; margin-right: 10px;" />
        </div>
      </div>

      <button (click)="selectAnnonce(annonce)">Modifier</button>
      <button (click)="deleteAnnonce(annonce.id)">Supprimer</button>
    </div>
  </div>


  <!-- Commentaires -->
  <div class="commentaires-section" *ngIf="selectedAnnonce">
    <h3>Commentaires</h3>
    <form (ngSubmit)="createCommentaire(selectedAnnonce.id)">
      <textarea [(ngModel)]="newCommentaire.contenu" name="contenu" required></textarea>
      <button type="submit">Ajouter un commentaire</button>
    </form>

    <div *ngFor="let commentaire of commentaires">
      <p>{{ commentaire.utilisateurName }}: {{ commentaire.contenu }}</p>
      <button (click)="updateCommentaire(commentaire)">Modifier</button>
      <button (click)="deleteCommentaire(commentaire.id)">Supprimer</button>
    </div>
  </div>
</div>
